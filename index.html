<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
  
  
  
  
  <title>AmberWang&#39;s World</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="AmberWang&#39;s World">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="AmberWang&#39;s World">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Amber Wang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="AmberWang&#39;s World" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 4.2.1"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/me.jpg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Amber Wang</a></h1>
        </hgroup>
        
        <p class="header-subtitle">Do what you like.</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/archives/">所有文章</a></li>
                        
                            <li><a  href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="/xxxxx" title="github">github</a>
                            
                                <a class="fl weibo"  target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://blog.csdn.net/baidu_21483933">csdn</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://segmentfault.com/blog/maocg_web">segmentfault</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.jianshu.com/users/eb37ef89c746/latest_articles">简书</a>
                    
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱动漫,爱游戏,爱编程,爱运动,爱的太多了!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Amber Wang</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/me.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Amber Wang</a></h1>
            </hgroup>
            
            <p class="header-subtitle">Do what you like.</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="/xxxxx" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-【MySQL】04" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2020/06/25/%E3%80%90MySQL%E3%80%9104/" class="article-date">
      <time datetime="2020-06-25T09:32:33.873Z" itemprop="datePublished">2020-06-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2020/06/25/%E3%80%90MySQL%E3%80%9104/">【MySQL】04</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><p>应用场景：当要显示的数据，一页显示不全，需要分页提交sql请求<br>语法：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">from 表</span><br><span class="line">[join type]  join 表2</span><br><span class="line">on 连接条件</span><br><span class="line">where 筛选条件</span><br><span class="line">group by 分组字段</span><br><span class="line">having 分组后的筛选</span><br><span class="line">order by 排序的字段</span><br><span class="line">limit offset,size;</span><br><span class="line"></span><br><span class="line">#offset 要显示的条目的起始索引（起始索引从0开始）</span><br><span class="line">#size 要显示的条目个数  </span><br><span class="line">&#96;&#96;&#96;   </span><br><span class="line"></span><br><span class="line">特点：</span><br><span class="line">- LIMIT 语句放在查询语句的最后</span><br><span class="line">- 公式：要显示的页数pege，每页的条目数size, 公式如下：</span><br></pre></td></tr></table></figure>
<p>select 查询列表<br>from 表<br>limit (page-1)*size,size;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">案例1：查询前五条员工信息  </span><br><span class="line">&#96;select * from employees LIMIT 0,5;&#96;  </span><br><span class="line">或&#96;select * from employees LIMIT 5;&#96;（省略开始）  </span><br><span class="line">案例2：查询第11条-第25条  </span><br><span class="line">&#96;select *from employees LIMIT 10,15;&#96;  </span><br><span class="line">案例3：有奖金的员工信息，并且工资较高的前10名显示出来</span><br></pre></td></tr></table></figure>
<p>select *<br>from employees<br>where commission_pct is not null<br>order by salary DESC<br>limit 10;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">### 联合查询  </span><br><span class="line">union 联合 合并：将多条查询语句的结果合并成一个结果  </span><br><span class="line">- 语法：  </span><br><span class="line">查询语句1  </span><br><span class="line">UNION  </span><br><span class="line">查询语句2  </span><br><span class="line">UNION  </span><br><span class="line">...</span><br><span class="line">- 应用场景：  </span><br><span class="line">要查询的结果来自于多个表，且多个表没有直接的连接关系，但查询的信息一致  </span><br><span class="line">- 特点：</span><br><span class="line">    - 要求多条查询语句的查询列数是一致的！</span><br><span class="line">    - 要求多条查询语句的查询的每一列的类型和顺序最好一致</span><br><span class="line">    - union关键字默认去重，使用union all 可以包含重复项</span><br><span class="line"></span><br><span class="line">案例：查询部门编号&gt;90或邮箱包含a的员工信息  </span><br><span class="line">普通写：</span><br></pre></td></tr></table></figure>
<p>select *<br>from employees<br>where department_id&gt;90 or email like ‘%a%’;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用union：</span><br></pre></td></tr></table></figure>
<p>select * from employees where department_id&gt;90<br>UNION<br>select * from employees where email like ‘%a%’;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">## DML语言  </span><br><span class="line">### 数据操作语言</span><br><span class="line">- 插入：insert</span><br><span class="line">- 修改：update</span><br><span class="line">- 删除：delete  </span><br><span class="line">#### 插入语句  </span><br><span class="line">- 语法：</span><br><span class="line">    - 方式1：</span><br><span class="line">&#96;insert into 表名 (列名, ... ) values(值1, ...);&#96;  </span><br><span class="line">    - 方式2：</span><br><span class="line">&#96;insert into 表名 set 列名&#x3D;值,列名&#x3D;值;...;&#96; </span><br><span class="line">- 特点：</span><br><span class="line">    - 插入的值的类型要与列的类型一致或兼容</span><br><span class="line">    - 不可以为null的列必须插入值，可以为null的列也可以省略</span><br><span class="line">    - 列的顺序可以调换</span><br><span class="line">    - 列数与值的个数必须一致</span><br><span class="line">    - 可以省略列名，默认所有列，而且列的顺序和表中列的顺序一致（所以不能省略列的个数对应的值）</span><br></pre></td></tr></table></figure>
<p>INSERT INTO beauty(id,name,sex,borndate,phone,boyfriend_id)<br>VALUES(13,’唐艺昕’,’女’,’1990-4-23’,’18999999’,NULL,2);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 两个方式比较</span><br><span class="line">    - 方式一支持插入多行，方式二不支持</span><br><span class="line">    - 方式一支持子查询，方式二不支持</span><br></pre></td></tr></table></figure>
<p>insert into beauty(id,name,phone)<br>select 26,’宋茜’,’19398434433’;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#### 修改语句  </span><br><span class="line">- 修改单表的记录</span><br><span class="line">    - 语法：  </span><br><span class="line">    update 表名  </span><br><span class="line">    set 列&#x3D;新值,列&#x3D;新值,...   </span><br><span class="line">    where 筛选条件;</span><br><span class="line">- 修改多表的记录</span><br><span class="line">    - 语法：（199语法）  </span><br><span class="line">    updata 表1 别名  </span><br><span class="line">    inner|left|right join 表2 别名  </span><br><span class="line">    on 连接条件</span><br><span class="line">    set 列&#x3D;值,...  </span><br><span class="line">    where 筛选条件;</span><br><span class="line"></span><br><span class="line">#### 删除语句  </span><br><span class="line">- 方式一：delete  </span><br><span class="line">    - 语法：</span><br><span class="line">        - 单表的删除 &#96;delete from 表名 where 筛选条件&#96;</span><br><span class="line">        - 多表的删除:</span><br></pre></td></tr></table></figure>
<p>delete 表1的别名，表2的别名<br>from 表1 别名<br>inner|left|right join 表2 别名 on 连接条件<br>where 筛选条件;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- 方式二：truncate</span><br><span class="line">    - 语法&#96;truncate table 表名&#96;</span><br><span class="line">    - 删除表中全部数据（一删全删）</span><br><span class="line"></span><br><span class="line">案例1：删除手机号以9结尾的女神信息  </span><br><span class="line">&#96;delete from beauty where phone like &#39;%9&#39;;&#96;  </span><br><span class="line"></span><br><span class="line">案例2：删除张无忌的女朋友的信息</span><br></pre></td></tr></table></figure>
<p>delete b<br>from beauty b<br>inner join boys bo<br>on b.boyfirend_id=bo.id<br>where bo.boyname=’张无忌’;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">*delete与truncate区别（常见面试题）*</span><br><span class="line">- delete可以加where，truncate不能</span><br><span class="line">- truncate效率高一点</span><br><span class="line">- 假如要删除的表中有自增长列，如果用delete删除后，再插入数据，自增长列的值从断点开始，而trucate删除后，再插入数据，自增长列的值从1开始。</span><br><span class="line">- truncate删除没有返回值，delete删除有返回值（有几行删除了）</span><br><span class="line">- truncate删除不能回滚，delete删除可以回滚</span><br><span class="line"></span><br><span class="line">## DDL语言  </span><br><span class="line">### 数据定义语言（是对库和表的管理和操作）  </span><br><span class="line">- 创建 create</span><br><span class="line">- 修改 alter</span><br><span class="line">- 删除 drop</span><br><span class="line">------------------ </span><br><span class="line"></span><br><span class="line">#### 库的管理  </span><br><span class="line">- 库的创建</span><br><span class="line">    - 语法：&#96;create database [if not exists]库名;&#96;  </span><br><span class="line">if not exists 如果存在不建但不会报错，不存在再新建，提高容错性</span><br><span class="line">- 库的修改</span><br><span class="line">    - 一般不修改</span><br><span class="line">    - 更改库的字符集:  </span><br><span class="line">    &#96;alter database books character set gbk;&#96;</span><br><span class="line">- 库的删除</span><br><span class="line">    - 语法：&#96;drop database [if exists]库名;&#96;  </span><br><span class="line">#### 表的管理  </span><br><span class="line">- 表的创建</span><br><span class="line">    - 语法：</span><br></pre></td></tr></table></figure>
<p>create table 表名(<br>    列名 列的类型【(长度)约束】,<br>    列名 列的类型【(长度)约束】,<br>    …<br>    列名 列的类型【(长度)约束】<br>);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">案例：创建表book</span><br></pre></td></tr></table></figure>
<p>create table book(<br>    id INT, #编号<br>    bname VARCHAR(20), #图书名<br>    price DOUBLE, #价格<br>    authorid INT, #作者编号<br>    publishData DATETIME #出版日期<br>);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- 表的修改</span><br><span class="line">    - 语法  </span><br><span class="line">&#96;alter table 表名 add|drop|modify|change column 列名 【列类型 约束】;&#96;</span><br><span class="line">    - 修改列名  </span><br><span class="line">    &#96;ALTER TABLE book CHANGE COLUMN publishData pubDate DATETIME; &#96;</span><br><span class="line">    - 修改列的类型或约束  </span><br><span class="line">    &#96;ALTER TABLE book MODIFY COLUMN pubDate TIMESTAMP; &#96;</span><br><span class="line">    - 添加新列  </span><br><span class="line">    &#96;ALTER TABLE author ADD COLUMN annual DOUBLE;&#96;</span><br><span class="line">    - 删除列  </span><br><span class="line">    &#96;ALTER TABLE author DROP COLUMN annual;&#96;</span><br><span class="line">    - 修改表名  </span><br><span class="line">    &#96;ALTER TABLE author RENAME TO book_author;&#96;</span><br><span class="line">- 表的删除</span><br><span class="line">    - 语法 &#96;drop table [if exists] book_author;&#96;</span><br><span class="line">- 表的复制  </span><br><span class="line">    - 仅仅复制表的结构  </span><br><span class="line">    &#96;CREATE TABLE copy LIKE author;&#96;</span><br><span class="line">    - 复制表的结构+数据</span><br></pre></td></tr></table></figure>
<p>CREATE TABLE copy<br>SELECT * FROM author;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 常见的数据类型  </span><br><span class="line">- 数值型</span><br><span class="line">    - 整型</span><br><span class="line">    - 小数</span><br><span class="line">        - 定点数</span><br><span class="line">        - 浮点数</span><br><span class="line">- 字符型</span><br><span class="line">    - 较短的文本：char、varchar</span><br><span class="line">    - 较长的文本：text、blob（较长的二进制数据）</span><br><span class="line">- 日期型</span><br><span class="line">### 整型</span><br><span class="line">- 分类</span><br><span class="line">    - tinyint 1</span><br><span class="line">    - smallint 2</span><br><span class="line">    - mediumint 3</span><br><span class="line">    - int&#x2F;integer 4</span><br><span class="line">    - bigint 8</span><br><span class="line">- 特点</span><br><span class="line">    - 如果不设置无符号还是有符号，默认是有符号，如果想设置无符号，需要添加unsigned关键字</span><br><span class="line">    - 如果插入的数值超出了整型的范围，会报out of range异常，并且插入临界值</span><br><span class="line">    - 如果不设置长度，会有默认的长度，长度代表了显示的最大宽度，如果不够会用0在左边填充，但必须搭配zerofill使用！</span><br><span class="line">### 小数  </span><br><span class="line">- 浮点型 </span><br><span class="line">    - float(M,D)</span><br><span class="line">    - double(M,D)</span><br><span class="line">- 定点型</span><br><span class="line">    - dec(M,D)</span><br><span class="line">    - decimal(M,D)</span><br><span class="line">- 特点</span><br><span class="line">    - M ：代表整数部位+小数部位 D：小数部位。如果超过范围，则插入临界值</span><br><span class="line">    - M和D都可以省略  </span><br><span class="line">    如果是decimal，则M默认为10，D默认为0  </span><br><span class="line">    如果是float和double，则会根据插入的数值的精度来决定精度  </span><br><span class="line">    - 定点型的精确度较高，如果要求插入数值的精度较高如货币运算等则考虑使用</span><br><span class="line">- 原则  </span><br><span class="line">    - 所选择的类型越简单越好，能保存数值的类型越小越好</span><br><span class="line">### 字符型  </span><br><span class="line">| - | 写法 | M的意思 | 特点| 空间耗费|效率|</span><br><span class="line">| :-----| :----: | :----: |:----: |:----: |:----: |</span><br><span class="line">| char | char(M) | 最大的字符数，可省略，默认1 |固定长度的字符 | 高| 高|</span><br><span class="line">| varchar | varchar(M) | 最大的字符数，不可以省略 |可变长度的字符|低 | 低|  </span><br><span class="line">### 枚举型ENUM</span><br></pre></td></tr></table></figure>
<p>create table tab_char(<br>    c1 ENUM(‘a’,’b’,’c’)<br>);</p>
<pre><code>### set集合  
### 日期型
- 分类
    - date 只保存日期
    - time 只保存时间
    - year 只保存年
    - datetime 保存日期+时间
    - timestamp 保存日期+时间

| - | 字节 | 范围 | 时区等的影响 |
| :-----| :----: | :----: |:----: |
| datetime | 8 | 1000-9999 |不受 |
| timestamp | 4 | 1970-2038 |受|</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-【MySQL】06" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2020/06/25/%E3%80%90MySQL%E3%80%9106/" class="article-date">
      <time datetime="2020-06-25T09:01:26.612Z" itemprop="datePublished">2020-06-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2020/06/25/%E3%80%90MySQL%E3%80%9106/">【MySQL】06</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><ul>
<li>系统变量  <ul>
<li>全局变量 <code>global</code></li>
<li>会话变量 <code>session</code></li>
</ul>
</li>
<li>自定义变量<ul>
<li>用户变量</li>
<li>局部变量<h3 id="系统变量"><a href="#系统变量" class="headerlink" title="系统变量"></a>系统变量</h3></li>
</ul>
</li>
<li>说明：变量由系统提供，不是用户定义，属于服务器层面</li>
<li>语法<ul>
<li>查看所有的系统变量<br><code>show global|[session] variables;</code></li>
<li>查看满足条件的部分系统变量<br><code>show global|[session] variables like &#39;%char%&#39;;</code></li>
<li>查看指定的某个系统变量的值<br><code>select @@global|[session].系统变量名;</code></li>
<li>为某个系统变量赋值<br><code>set global|[session] 系统变量名=值</code><br>或者<code>set @@global|[session].系统变量名=值</code>  </li>
</ul>
</li>
<li>注意：如果是全局级别，则需要加global，如果是会话级别，则需要加session，如果不写，则默认session</li>
</ul>
<h4 id="全局变量-global"><a href="#全局变量-global" class="headerlink" title="全局变量  global"></a>全局变量  <code>global</code></h4><ul>
<li>作用域：服务器每次启动将为所有的全局变量赋初始值，针对于所有的会话（连接）有效，但不能跨重启<h4 id="会话变量-session"><a href="#会话变量-session" class="headerlink" title="会话变量 session"></a>会话变量 <code>session</code></h4></li>
<li>作用域：仅仅针对于当前会话（连接）有效</li>
</ul>
<h3 id="自定义变量"><a href="#自定义变量" class="headerlink" title="自定义变量"></a>自定义变量</h3><ul>
<li>说明：变量是用户自定义的，不是由系统定义的</li>
<li>使用步骤：<ul>
<li>声明</li>
<li>赋值</li>
<li>使用（查看、比较、运算等）</li>
</ul>
</li>
</ul>
<h4 id="用户变量"><a href="#用户变量" class="headerlink" title="用户变量"></a>用户变量</h4><ul>
<li>作用域：针对于当前会话（连接）有效，同于会话变量的作用域</li>
<li>步骤<ul>
<li>声明并初始化（赋值的操作符：=或:=）<br><code>set @用户变量名=值;  
set @用户变量名:=值;  
select @用户变量名:=值;</code> </li>
<li>赋值（更新用户变量的值）  <ul>
<li>方式一：<br><code>set @用户变量名=值;  
set @用户变量名:=值;  
select @用户变量名:=值;</code> </li>
<li>方式二：<br><code>select 字段 into @变量名 from 表;</code></li>
</ul>
</li>
<li>使用（查看用户变量的值）<br><code>select @用户变量名</code></li>
</ul>
</li>
<li>应用在任何地方</li>
</ul>
<p>案例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#声明并初始化</span><br><span class="line">set @name&#x3D;&#39;john&#39;;</span><br><span class="line">set @name&#x3D;100;</span><br><span class="line">set @count&#x3D;1;</span><br><span class="line">#赋值</span><br><span class="line">select count(*) into @count</span><br><span class="line">from employees;</span><br><span class="line">#查看</span><br><span class="line">select @count;</span><br></pre></td></tr></table></figure>
<h4 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h4><ul>
<li>作用域：仅仅在定义它的begin end中有效，应用在begin end中的第一句话</li>
<li>步骤<ul>
<li>声明<br><code>declare 变量名 类型;</code><br><code>declare 变量名 类型 default 值;</code></li>
<li>赋值<ul>
<li>方式一：<br><code>set 用户变量名=值;  
set 用户变量名:=值;  
select @用户变量名:=值;</code> </li>
<li>方式二：<br><code>select 字段 into 局部变量名 from 表;</code></li>
</ul>
</li>
<li>使用<br><code>select 局部变量名;</code>  </li>
</ul>
</li>
</ul>
<p><em>用户变量与局部变量对比</em><br>| - | 作用域 | 定义和使用的位置 | 语法 |<br>| :—–| :—-: | :—-: |:—-:|<br>| 用户变量 | 当前会话 | 会话中的任何地方 |必须加@符号,不用限定类型 |<br>| 局部变量 | begin end中| 只能在begin end中，且为第一句 |一般不加@，除非select，需要限定类型|<br>案例：声明两个变量并初始值，求和，并打印</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#用户变量</span><br><span class="line">set @m&#x3D;1;</span><br><span class="line">set @n&#x3D;2;</span><br><span class="line">set @sum&#x3D;@m+@n;</span><br><span class="line">select @sum;</span><br></pre></td></tr></table></figure>
<h2 id="存储过程和函数（类似方法）"><a href="#存储过程和函数（类似方法）" class="headerlink" title="存储过程和函数（类似方法）"></a>存储过程和函数（类似方法）</h2><ul>
<li>含义：一组预先编译好的SQL语句的集合，理解为批处理语句</li>
<li>好处：<ul>
<li>提高代码的重用性</li>
<li>简化操作</li>
<li>减少了编译次数并且减少了和数据库服务器连接的次数，提高了效率<h3 id="创建语法"><a href="#创建语法" class="headerlink" title="创建语法"></a>创建语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create procedure 存储过程名(参数列表)(</span><br><span class="line">begin</span><br><span class="line">    存储过程体（一组合法的sql语句）</span><br><span class="line">end</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>注意<ul>
<li>参数列表包含三部分<ul>
<li>参数模式 <code>IN</code></li>
<li>参数名 <code>stuname</code></li>
<li>参数类型 <code>VARCHAR(20)</code></li>
</ul>
</li>
<li>参数模式<ul>
<li><code>IN</code>：该参数可以作为输入，即需要调用传入值</li>
<li><code>OUT</code>：作为输出，即可以作为返回值</li>
<li><code>INOUT</code>：即需要传入值，又可以返回值</li>
</ul>
</li>
<li>如果存储过程体仅仅只有一句话，begin end可以省略。存储过程体的每条SQL语句的结尾必须加分号。存储过程的结尾可以使用DELIMITER重新设置<ul>
<li>语法：<code>DELIMITER 结束标记</code><h3 id="调用语法"><a href="#调用语法" class="headerlink" title="调用语法"></a>调用语法</h3><code>call 存储过程名（实参列表）;</code>  </li>
</ul>
</li>
</ul>
</li>
</ul>
<p>案例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from admin;</span><br><span class="line">delimiter $</span><br><span class="line">create procedure myp1()</span><br><span class="line">begin</span><br><span class="line">    insert into admin(username,&#39;password&#39;) values(&#39;john1&#39;,&#39;000&#39;,&#39;john2&#39;,&#39;000&#39;,&#39;john3&#39;,&#39;000&#39;,&#39;john4&#39;,&#39;000&#39;,&#39;john5&#39;,&#39;000&#39;);</span><br><span class="line">end $</span><br><span class="line">#调用</span><br><span class="line">call myp1()$</span><br></pre></td></tr></table></figure>
<h4 id="创建带in模式参数的存储过程"><a href="#创建带in模式参数的存储过程" class="headerlink" title="创建带in模式参数的存储过程"></a>创建带in模式参数的存储过程</h4><p>案例1：创建存储过程实现：根据女神名，查询对应的男神信息   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create procedure myp2(IN beautyName VARCHAR(20))</span><br><span class="line">begin</span><br><span class="line">    select bo.*</span><br><span class="line">    from boys bo</span><br><span class="line">    right join beauty b on bo.id&#x3D;b.boyfriend_id</span><br><span class="line">    where b.name&#x3D;beautyName;</span><br><span class="line">end $</span><br><span class="line">#调用</span><br><span class="line">call myp2(&#39;柳岩&#39;)$</span><br></pre></td></tr></table></figure>
<p>案例2：创建存储过程实现，用户是否登录成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create procedure myp4(IN username VARCHAR(20),IN PASSWORD VARCHAR(20))</span><br><span class="line">BEGIN</span><br><span class="line">    DECLARE result into default 0;#声明并初始化</span><br><span class="line">    select count(*) into result #赋值</span><br><span class="line">    from admin</span><br><span class="line">    where admin.username &#x3D; username</span><br><span class="line">    AND admin.password &#x3D; PASSWORD;</span><br><span class="line">    select IF(result&gt;0,&#39;成功&#39;,&#39;失败&#39;); #使用</span><br><span class="line">END$</span><br><span class="line">#调用</span><br><span class="line">CALL myp4(&#39;张飞&#39;,&#39;8888&#39;)$</span><br></pre></td></tr></table></figure>

<h4 id="带out模式参数的存储过程"><a href="#带out模式参数的存储过程" class="headerlink" title="带out模式参数的存储过程"></a>带out模式参数的存储过程</h4><p>案例1：根据女神名，返回对应的男神名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create procedure myp5(IN beautyName VARCHAR(20),OUT boyName VARCHAR(20))</span><br><span class="line">begin</span><br><span class="line">    select bo.boyName INTO boyName</span><br><span class="line">    from boys bo</span><br><span class="line">    INNER JOIN beauty b ON bo.id &#x3D; b.boyfriend_id</span><br><span class="line">    WHERE b.name &#x3D; beautyName;</span><br><span class="line">end $</span><br><span class="line">#调用</span><br><span class="line">CALL myp5(&#39;小昭&#39;,@bName)$</span><br><span class="line">select @bName $</span><br></pre></td></tr></table></figure>
<p>案例2：根据女神名，返回对应的男神名和男神魅力值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create procedure myp6(IN beautyName VARCHAR(20),OUT boyName VARCHAR(20),OUT userCP INT)</span><br><span class="line">begin</span><br><span class="line">    select bo.boyName, bo.userCP INTO boyName,userCP</span><br><span class="line">    from boys bo</span><br><span class="line">    INNER JOIN beauty b ON bo.id &#x3D; b.boyfriend_id</span><br><span class="line">    WHERE b.name &#x3D; beautyName;</span><br><span class="line">end $</span><br><span class="line">#调用</span><br><span class="line">CALL myp6(&#39;小昭&#39;,@bName,@userCP)$</span><br><span class="line">select @bName,@userCP $</span><br></pre></td></tr></table></figure>

<h4 id="带inout模式参数的存储过程"><a href="#带inout模式参数的存储过程" class="headerlink" title="带inout模式参数的存储过程"></a>带inout模式参数的存储过程</h4><p>案例1；传入a和b两个值，最终a,b翻倍并返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create procedure myp8(inout a INT, inout b INT)</span><br><span class="line">begin</span><br><span class="line">    set a&#x3D;a*2;</span><br><span class="line">    set b&#x3D;b*2;</span><br><span class="line">end $</span><br><span class="line">#调用</span><br><span class="line">set @m&#x3D;10 $</span><br><span class="line">set @n&#x3D;20 $</span><br><span class="line">CALL myp8(@m,@n) $</span><br><span class="line">selet @m,@n $</span><br></pre></td></tr></table></figure>
<h3 id="删除存储过程"><a href="#删除存储过程" class="headerlink" title="删除存储过程"></a>删除存储过程</h3><ul>
<li>语法 <code>drop procedure 存储过程名</code><br><code>drop procedure p1;</code><br><code>drop procedure p2,p3;</code> × 不可以同时删除多个<h3 id="查看存储过程的信息"><a href="#查看存储过程的信息" class="headerlink" title="查看存储过程的信息"></a>查看存储过程的信息</h3><code>DESC myp2;</code>×<br><code>SHOW create procedure myp2;</code> √</li>
</ul>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p><em>与存储过程对比</em><br>存储过程：可以有0个返回，也可以有多个返回，适合做批量插入、批量更新<br>函数：有且仅有1个返回，适合做处理数据后返回一个结果</p>
<h3 id="创建语法-1"><a href="#创建语法-1" class="headerlink" title="创建语法"></a>创建语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create function 函数名（参数列表） returns 返回类型</span><br><span class="line">begin</span><br><span class="line">    函数体</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>参数列表 包含两部分：参数名 参数类型</li>
<li>函数体：肯定会有return语句，如果没有会报错，如果return语句没有放在函数体的最后也不报错，但没有意义<br>格式 <code>return 值;</code></li>
<li>函数体重仅有一句话，则可以省略begin end</li>
<li>使用delimiter语句设置结束标记</li>
</ul>
<h4 id="无参有返回"><a href="#无参有返回" class="headerlink" title="无参有返回"></a>无参有返回</h4><p>案例：返回公司的员工个数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create function myf1() returns int</span><br><span class="line">begin </span><br><span class="line">    declare c int default 0;#定义变量</span><br><span class="line">    select count(*) into c #赋值</span><br><span class="line">    from employees;</span><br><span class="line">    return c;</span><br><span class="line">end</span><br><span class="line">select myf1();</span><br></pre></td></tr></table></figure>

<h4 id="有参有返回"><a href="#有参有返回" class="headerlink" title="有参有返回"></a>有参有返回</h4><p>案例：根据员工名，返回他的工资</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create function myf2(empName VARCHAR(20)) returns double</span><br><span class="line">begin</span><br><span class="line">    set @sal&#x3D;0; #定义用户变量</span><br><span class="line">    select salary into @sal #赋值</span><br><span class="line">    from employees</span><br><span class="line">    where last_name &#x3D; empName;</span><br><span class="line">    return @sal;</span><br><span class="line">end $</span><br><span class="line">select myf2(&#39;k_ing&#39;) $</span><br></pre></td></tr></table></figure>
<p>案例：根据部门名，返回该部门的平均工资</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create function myf3(depName VARCHAR(20)) returns double</span><br><span class="line">begin</span><br><span class="line">    declare sal double;</span><br><span class="line">    select AVG(salary) INTO sal</span><br><span class="line">    from employees e</span><br><span class="line">    JOIN departments d </span><br><span class="line">    ON e.department_id&#x3D;d.department_id</span><br><span class="line">    where d.department_name&#x3D;depNamel</span><br><span class="line">    return sal;</span><br><span class="line">end $</span><br><span class="line">SELECT myf3(&#39;IT&#39;) $</span><br></pre></td></tr></table></figure>
<h3 id="查看函数"><a href="#查看函数" class="headerlink" title="查看函数"></a>查看函数</h3><p><code>show create function myf3;</code></p>
<h3 id="删除函数"><a href="#删除函数" class="headerlink" title="删除函数"></a>删除函数</h3><p><code>drop function myf3;</code></p>
<p>案例：创建函数，实现传入两个float，返回二者之和</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create function test_fun1(num1 float,num2 float) returns float</span><br><span class="line">begin</span><br><span class="line">    declare sum float default 0;</span><br><span class="line">    set sum&#x3D;num1+num2;</span><br><span class="line">    return sum;</span><br><span class="line">end $</span><br><span class="line">select test_fun1(1,2) $</span><br></pre></td></tr></table></figure>

<h2 id="流程控制结构"><a href="#流程控制结构" class="headerlink" title="流程控制结构"></a>流程控制结构</h2><ul>
<li>顺序结构：程序从上往下依次执行</li>
<li>分支结构：程序从两条或多条路径中选择一条去执行</li>
<li>循环结构：程序在满足一定条件的基础上，重复执行一段代码</li>
</ul>
<h3 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h3><h4 id="IF函数"><a href="#IF函数" class="headerlink" title="IF函数"></a>IF函数</h4><ul>
<li>语法：<code>select IF(表达式1，表达式2，表示式3);</code></li>
<li>执行顺序：如果表达式1成立，则if函数返回表达式2的值，否则返回表达式3的值</li>
<li>应用：任何地方<h4 id="CASE结构"><a href="#CASE结构" class="headerlink" title="CASE结构"></a>CASE结构</h4></li>
<li>情况1：类似于JAVA的switch语句，一般用于实现等值判断<ul>
<li>语法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">case 变量|表达式|字段&#96;  </span><br><span class="line">when 要判断的值 then 返回的值1或语句1</span><br><span class="line">when 要判断的值 then 返回的值2或语句2</span><br><span class="line">...</span><br><span class="line">else 要返回的值n或语句n</span><br><span class="line">end (end case (如果是语句的话))</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>情况2：类似于JAVA中的多重if语句，一般用于实现区间判断<ul>
<li>语法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">case </span><br><span class="line">when 要判断的条件1 then 返回的值1或语句1;</span><br><span class="line">when 要判断的条件2 then 返回的值2或语句2;</span><br><span class="line">...</span><br><span class="line">else 要返回的值n或语句n;</span><br><span class="line">end (case);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>特点<ul>
<li>可以作为表达式，嵌套在其他语句中使用，可以放在任何地方</li>
<li>可以作为独立的语句，只能放在begin end中</li>
<li>else可以省略，如果else省略，并且所有的条件都不满足，返回NULL</li>
</ul>
</li>
</ul>
<p>案例：创建存储过程，根据传入的成绩，来显示等级，比如传入的成绩：90-100 显示A；80-90 B；60-80 C；否则显示D</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create procedure test_case(IN score INT)</span><br><span class="line">begin</span><br><span class="line">    case</span><br><span class="line">    when score &gt;&#x3D; 90 and score &lt;&#x3D; 100 then select &#39;A&#39;;</span><br><span class="line">    when score &gt;&#x3D; 80 then select &#39;B&#39;;</span><br><span class="line">    when score &gt;&#x3D; 60 then select &#39;C&#39;;</span><br><span class="line">    else select &#39;D&#39;;</span><br><span class="line">    end case;</span><br><span class="line">end $</span><br><span class="line">call test_case(95);</span><br></pre></td></tr></table></figure>
<h4 id="IF结构"><a href="#IF结构" class="headerlink" title="IF结构"></a>IF结构</h4><ul>
<li>功能：实现多重分支</li>
<li>语法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if 条件1 then 语句1;</span><br><span class="line">elseif 条件2 then 语句2;</span><br><span class="line">...</span><br><span class="line">[else 语句n;]</span><br><span class="line">end if;</span><br></pre></td></tr></table></figure></li>
<li>应用在begin end中</li>
</ul>
<h3 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h3><ul>
<li>分类：while、loop、repeat</li>
<li>循环控制：iterate类似于continue，继续，结束本次循环，继续下一次；leave类似于 break 跳出，结束当前所在的循环  <h4 id="while"><a href="#while" class="headerlink" title="while"></a>while</h4></li>
<li>语法<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">【标签：】while 循环条件 do</span><br><span class="line">    循环体;</span><br><span class="line">end while 【标签】;</span><br></pre></td></tr></table></figure>
<h4 id="loop"><a href="#loop" class="headerlink" title="loop"></a>loop</h4></li>
<li>语法<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">【标签：】loop</span><br><span class="line">    循环体;</span><br><span class="line">end loop 【标签】;</span><br></pre></td></tr></table></figure></li>
<li>可以用来模拟简单的死循环<h4 id="repeat"><a href="#repeat" class="headerlink" title="repeat"></a>repeat</h4></li>
<li>语法<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">【标签：】repeat</span><br><span class="line">    循环体;</span><br><span class="line">until 结束循环的条件</span><br><span class="line">end repeat 【标签】;</span><br></pre></td></tr></table></figure>
案例1：批量插入，根据次数插入到admin表中多条记录<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create procedure pro_while1(IN insertcount INT)</span><br><span class="line">begin</span><br><span class="line">    declear i INT default 1;</span><br><span class="line">    while i&lt;&#x3D;insertCount DO</span><br><span class="line">        INSERT INTO admin(username,&#39;password&#39;) VALUES(CONCAT(&#39;Rose&#39;,i),&#39;666&#39;);</span><br><span class="line">        SET i&#x3D;i+1;</span><br><span class="line">    end while;</span><br><span class="line">end;</span><br><span class="line">CALL pro_while1(100);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>案例2（添加leave语句）：批量插入，根据次数插入到admin表中多条记录，如果次数&gt;20则停止</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create procedure pro_while2(IN insertcount INT)</span><br><span class="line">begin</span><br><span class="line">    declear i INT default 1;</span><br><span class="line">    a:while i&lt;&#x3D;insertCount DO</span><br><span class="line">        INSERT INTO admin(username,&#39;password&#39;) VALUES(CONCAT(&#39;Rose&#39;,i),&#39;666&#39;);</span><br><span class="line">        IF i&gt;&#x3D;20 THEN LEAVE a;</span><br><span class="line">        END IF;</span><br><span class="line">        SET i&#x3D;i+1;</span><br><span class="line">    end while a;</span><br><span class="line">end;</span><br><span class="line">CALL pro_while1(100);</span><br></pre></td></tr></table></figure>
<p>案例3（添加iterate语句）：偶数次添加，奇数次不添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create procedure pro_while2(IN insertcount INT)</span><br><span class="line">begin</span><br><span class="line">    declear i INT default 0;</span><br><span class="line">    a:while i&lt;&#x3D;insertCount DO</span><br><span class="line">        set i&#x3D;i+1;</span><br><span class="line">        IF MOD(i,2)&#x3D;&#x3D;1 iterate a;</span><br><span class="line">        END IF;</span><br><span class="line">        INSERT INTO admin(username,&#39;password&#39;) VALUES(CONCAT(&#39;Rose&#39;,i),&#39;666&#39;);</span><br><span class="line">    end while a; </span><br><span class="line">end;</span><br><span class="line">CALL pro_while1(100);</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-【MySQL】05" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2020/06/25/%E3%80%90MySQL%E3%80%9105/" class="article-date">
      <time datetime="2020-06-25T09:01:26.607Z" itemprop="datePublished">2020-06-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2020/06/25/%E3%80%90MySQL%E3%80%9105/">【MySQL】05</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="常见约束"><a href="#常见约束" class="headerlink" title="常见约束"></a>常见约束</h3><ul>
<li>含义：一种限制，用于限制表中的数据，为了保证表中的数据的准确和可靠性。  </li>
<li>分类：（六大约束）<ul>
<li>not null：非空，用于保证该字段的值不能为空<ul>
<li>比如姓名、学号等</li>
</ul>
</li>
<li>default: 默认，用于保证该字段有默认值<ul>
<li>比如性别</li>
</ul>
</li>
<li>primary key：主键，用于保证该字段的值具有唯一性，并且非空<ul>
<li>比如学号、员工编号等</li>
</ul>
</li>
<li>unique：唯一，用于保证该字段的值具有唯一性，可以为空 <ul>
<li>比如座位号</li>
</ul>
</li>
<li>check：检查约束【mysql中不支持】，用于加条件<ul>
<li>比如男和女，只能添加男或女</li>
</ul>
</li>
<li>foreign key：外键，用于限制两个表的关系，用于保证该字段的值必须来自于主表的关联列的值。在从表添加外键约束，用于引用主表中某列的值。<ul>
<li>比如学生表的专业编号，员工表的部门编号，员工表的工种编号</li>
</ul>
</li>
</ul>
</li>
<li>添加约束的时机<ul>
<li>创建表时</li>
<li>修改表时</li>
</ul>
</li>
<li>约束的添加分类<ul>
<li>列级约束<ul>
<li>六大约束语法上都支持，但外键约束没有效果</li>
</ul>
</li>
<li>表级约束<ul>
<li>除了非空、默认其他都支持</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="创建表时添加约束"><a href="#创建表时添加约束" class="headerlink" title="创建表时添加约束"></a>创建表时添加约束</h4><ul>
<li>添加列级约束  <ul>
<li>语法  <ul>
<li>直接在字段名和类型后面追加约束类型即可。  </li>
<li>只支持：默认、非空、主键、唯一<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table stuinfo(</span><br><span class="line">    id int primary key,#主键</span><br><span class="line">    stuName varchar(20) not null,#非空</span><br><span class="line">    gender char(1) check(gender&#x3D;&#39;男&#39; or gender&#x3D;&#39;女&#39;),#检查</span><br><span class="line">    seat int unique,#唯一</span><br><span class="line">    age int default 18,#默认约束</span><br><span class="line">    majorId int references major(id) #外键</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
查看stuinfo表中所以的索引，包括主键、外键、唯一<br><code>show index from stuinfo;</code></li>
</ul>
</li>
</ul>
</li>
<li>添加表级约束  <ul>
<li>语法<ul>
<li>在各个字段的最下面</li>
<li><code>[constraint 约束名] 约束类型（字段名）</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">create table stuinfo(</span><br><span class="line">    id INT,</span><br><span class="line">    stuname VARCHAR(20),</span><br><span class="line">    gender CHAR(1),</span><br><span class="line">    seat INT,</span><br><span class="line">    age INT,</span><br><span class="line">    majorId INT,</span><br><span class="line"></span><br><span class="line">    CONSTRAIT pk PRIMART KEY(id),#主键</span><br><span class="line">    CONSTRAIT uq UNIQUE(seat),#唯一键</span><br><span class="line">    CONSTRAIT ck CHECK(gender &#x3D; &#39;男&#39; or gender &#x3D; &#39;女&#39;),#检查</span><br><span class="line">    CONSTRAIT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id) #外键</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>通用写法<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">create table if not exists stuinfo(</span><br><span class="line">    id INT PRIMARY KEY,</span><br><span class="line">    stuname VARCHAR(20) NOT NULL,</span><br><span class="line">    sex CHAR(1),</span><br><span class="line">    age INT DEFAULT 18,</span><br><span class="line">    seat INT UNIQUE,</span><br><span class="line">    majorid INT,</span><br><span class="line">    CONSTRAIT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<p><em>主键和唯一的对比</em><br>| - | 保证唯一性 | 是否允许为空 | 一个表中可以有多少个null| 是否允许组合|<br>| :—–| :—-: | :—-: |:—-: |:—-: |<br>| 主键 | √ | × |至多有1个（？） | √，但不推荐|<br>| 唯一 | √ | √ |可以有多个|√，但不推荐 |</p>
<ul>
<li>外键<ul>
<li>要求在从表设置外键关系</li>
<li>从表的外键列的类型和主表的关联列的类型要求一致或兼容，名称无要求</li>
<li>主表的关联列必须是一个key（一般是主键或唯一）</li>
<li>插入数据时，先插入主表，再插入从表</li>
<li>删除数据时，先删除从表，再删除主表</li>
</ul>
</li>
</ul>
<h4 id="修改表时添加约束"><a href="#修改表时添加约束" class="headerlink" title="修改表时添加约束"></a>修改表时添加约束</h4><ul>
<li>语法<ul>
<li>添加列级约束<br><code>alter table 表名 modify column 字段名 字段类型 新约束;</code>  </li>
<li>添加表级约束<br><code>alter table 表名 add 【constraint 约束名】 约束类型（字段名） 【外键的引用】;</code></li>
</ul>
</li>
<li>添加非空约束<br><code>ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20) NOT NULL;</code></li>
<li>添加默认约束</li>
<li>添加主键约束</li>
<li>添加唯一</li>
<li>添加外键<br><code>ALTER TABLE stuinfo ADD FOREIGN KEY(majorid) REFERENCES major(id);</code></li>
</ul>
<h4 id="修改表时删除约束"><a href="#修改表时删除约束" class="headerlink" title="修改表时删除约束"></a>修改表时删除约束</h4><ul>
<li>删除外键<br><code>alter table stuinfo drop foreign key fk_stuinfo_major;</code></li>
</ul>
<h4 id="标识列"><a href="#标识列" class="headerlink" title="标识列"></a>标识列</h4><p>又称为自增长列<br>含义：可以不用手动的插入值，系统提供默认的序列值  </p>
<ul>
<li><p>创建表时设置标识列  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table tab_identity(</span><br><span class="line">    id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    NAME VARCHAR(20)</span><br><span class="line">);</span><br><span class="line">INSERT INTO tab_identify(id,name) VALUES(NULL,&#39;john&#39;);</span><br><span class="line">也可以省略</span><br><span class="line">INSERT INTO tab_identity(NAME) VALUES(&#39;lucy&#39;);</span><br></pre></td></tr></table></figure>
<p>可以将变量的步长更改，但不支持更改偏移量  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#39;%auto_increment%&#39;;</span><br><span class="line">SET auto_increment_increment&#x3D;3;</span><br></pre></td></tr></table></figure>
<p>若想更改起始值（即偏移量），可以先手动输入起始值。</p>
</li>
<li><p>特点  </p>
<ul>
<li>标识列必须和主键搭配吗？不一定，但要求是一个key</li>
<li>一个表可以有几个标识列？至多一个！</li>
<li>标识列的类型只能是数值型</li>
<li>标识列可以通过<code>SET auto_increment_increment=3</code>;设置步长，可以通过手动插入值，设置起始值</li>
</ul>
</li>
<li><p>修改表时设置标识列<br><code>ALTER TABLE tab_identity MODIFY COLUMN id INT PRIMARY KEY AUTO_INCREMENT;</code></p>
</li>
<li><p>修改表时删除标识列<br><code>ALTER TABLE tab_identity MODIFY COLUMN id INT PRIMARY KEY;</code></p>
</li>
</ul>
<h2 id="TCL语言"><a href="#TCL语言" class="headerlink" title="TCL语言"></a>TCL语言</h2><p>(Transaction Control Language) 事务控制语言  </p>
<ul>
<li><p>事务：一个或一组sql语句组成一个执行单元，这个执行单元要么全部执行，要么全部不执行。</p>
</li>
<li><p>案例：转账</p>
</li>
<li><p>存储引擎</p>
<ul>
<li>概念：在mysql中的数据用各种不同的技术存储在文件（或内存）中</li>
<li><code>show engines;</code>可以看到mysql支持的存储引擎</li>
<li>mysql中用的最多的：innodb(支持事务)、myisam、memory(不支持事务)</li>
</ul>
</li>
<li><p><em>事务的ACID（acid）属性（面试题）</em></p>
<ul>
<li>原子性（Atomicity）<br>原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。</li>
<li>一致性（Consistency）<br>事务必须使数据库从一个一致性状态变换到另一个一致性状态。比如转账时，转账双方总余额2000，就一直是2000。</li>
<li>隔离性（Isolation）<br>一个事务的执行不能被其他事务干扰。</li>
<li>持久性（Durability）<br>一个事务被提交，对数据库的改变是永久性的。</li>
</ul>
</li>
<li><p>事务的创建</p>
<ul>
<li>隐式事务<ul>
<li>事务没有明显的开启和结束的标记</li>
<li>比如insert、update、delete语句</li>
</ul>
</li>
<li>显示事务<ul>
<li>事务具有明显的开启和结束的标记</li>
<li>前提：必须先设置自动提交功能为禁用<br><code>set autocommit=0</code><br>(查看：<code>show variables like &#39;autocommit&#39;;</code>)</li>
</ul>
</li>
</ul>
</li>
<li><p>书写步骤</p>
<ul>
<li>步骤1：开启事务<br><code>set autocommit=0;</code><br><code>start transaction;</code>可选</li>
<li>步骤2：编写事务中的sql语句（select insert update delete）<br>语句1;<br>语句2;<br>…  </li>
<li>步骤3：结束事务<br><code>commit;</code> 提交事务<br><code>rollback;</code> 回滚事务</li>
</ul>
</li>
<li><p>事务的隔离级别：</p>
<ul>
<li>read uncommitted:出现脏读、不可重复读、幻读</li>
<li>read committed:避免出现脏读，出现不可重复读和幻读</li>
<li>repeatable read:避免出现脏读、不可重复读，出现幻读</li>
<li>serializable:都可以避免</li>
<li>mysql中默认第三个，oracle默认第二个</li>
<li>使用的命令<ul>
<li>查看隔离级别<br><code>select @@transaction_isolation;</code></li>
<li>设置隔离级别<br><code>set session|global transaction isolation level 隔离级别</code></li>
</ul>
</li>
</ul>
</li>
<li><p>delete 和truncate在事务使用时的区别  </p>
<ul>
<li>delete可以回滚，truncate不可以</li>
</ul>
</li>
<li><p>savepoint的使用  </p>
<ul>
<li>一般搭配rollback使用<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SET autocommit&#x3D;0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM account WHERE id&#x3D;25;</span><br><span class="line">SAVEPOINT a;#设置保存点</span><br><span class="line">DELETE FROM account WHERE id&#x3D;28;</span><br><span class="line">ROLLBACK TO a;#回滚到保存点</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><ul>
<li>含义：虚拟表，和普通表一样使用</li>
<li>mysql15.1版本出现的新特性，是通过表动态生成的数据</li>
<li>比如舞蹈班和普通版  </li>
<li>应用场景：<ul>
<li>多个地方用到同样的查询结果</li>
<li>该查询结果使用的sql语句较复杂</li>
</ul>
</li>
</ul>
<p>案例：查询姓张的学生名和专业名<br>普通写  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select stuname,majorname</span><br><span class="line">from stuinfo s</span><br><span class="line">inner join major m</span><br><span class="line">on s.majorid&#x3D;m.id</span><br><span class="line">where s.stuname like &#39;张%&#39;;</span><br></pre></td></tr></table></figure>
<p>用视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create view v1</span><br><span class="line">as</span><br><span class="line">select stuname,majorname</span><br><span class="line">from stuinfo s</span><br><span class="line">inner join major m</span><br><span class="line">on s.majorid&#x3D;m.id</span><br><span class="line">where s.stuname like &#39;张%&#39;;</span><br></pre></td></tr></table></figure>
<h3 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h3><ul>
<li>语法<br><code>create view 视图名 as 查询语句;</code></li>
<li>优点<ul>
<li>重用sql语句</li>
<li>简化复杂的sql操作</li>
<li>保护数据，提高安全性<h3 id="修改视图"><a href="#修改视图" class="headerlink" title="修改视图"></a>修改视图</h3></li>
</ul>
</li>
<li>语法 <ul>
<li>方式一：<br><code>create or replace view 视图名 as 查询语句;</code>  </li>
<li>方拾二：<br><code>alter view 视图名 as 查询语句;</code><h3 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h3></li>
</ul>
</li>
<li>语法<br><code>drop view 视图名,视图名,...;</code><h3 id="查看视图"><a href="#查看视图" class="headerlink" title="查看视图"></a>查看视图</h3></li>
<li>语法<br><code>DESC 视图名</code><br>或者<code>SHOW CREATE VIEW 视图名</code></li>
<li>视图的更新(很少用)  <ul>
<li>插入<br><code>INSERT INTO myv1 VALUES(&#39;张飞&#39;,&#39;zf@qq.com&#39;);</code></li>
<li>修改<br><code>UPDATE myv1 SET last_name=&#39;张无忌&#39; where last_name=&#39;张飞&#39;;</code></li>
<li>删除<br><code>DELETE FROM myv1 where last_name=&#39;张无忌&#39;;</code></li>
<li>也会更改掉原数据</li>
</ul>
</li>
<li>具备以下特点的视图不允许更新<ul>
<li>包含以下关键字的sql语言：分组函数、distinct、group by、having、union或者union all</li>
<li>常量视图</li>
<li>select 中包含子查询</li>
<li>join 连结</li>
<li>from一个不能更新的视图</li>
<li>where子句的子查询引用了from子句中的表<br>(基本上只能查询)  </li>
</ul>
</li>
</ul>
<p><em>视图与表的对比：</em>  </p>
<table>
<thead>
<tr>
<th align="left">-</th>
<th align="center">语法</th>
<th align="center">是否实际占用物理空间</th>
<th align="center">使用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">视图</td>
<td align="center">create view</td>
<td align="center">只保存了sql逻辑</td>
<td align="center">查</td>
</tr>
<tr>
<td align="left">表</td>
<td align="center">create table</td>
<td align="center">保存了数据</td>
<td align="center">增删改查</td>
</tr>
</tbody></table>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-【MySQL】03" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2020/06/25/%E3%80%90MySQL%E3%80%9103/" class="article-date">
      <time datetime="2020-06-25T09:01:26.597Z" itemprop="datePublished">2020-06-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2020/06/25/%E3%80%90MySQL%E3%80%9103/">【MySQL】03</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><p>含义：又称多表查询，当查询的字段来自于多个表时，就会用到连接查询。<br>笛卡尔乘积现象：表1 有m行，表2 有n行，结果=m*n行<br>发生原因：没有有效的连接条件<br>如何避免：添加有效的连接条件<br>分类：</p>
<ul>
<li>按年代分类：<ul>
<li>sq192标准：仅仅支持内连接</li>
<li>sq199标准【推荐】：支持内连接+外连接（左外+右外）+交叉连接</li>
</ul>
</li>
<li>按功能分类：  <ul>
<li>内连接：<ul>
<li>等值连接</li>
<li>非等值连接</li>
<li>自连接</li>
</ul>
</li>
<li>外连接：<ul>
<li>左外连接</li>
<li>右外连接</li>
<li>全外连接</li>
</ul>
</li>
<li>交叉连接  </li>
</ul>
</li>
</ul>
<p><strong>192标准</strong><br><strong>等值连接</strong><br>①多表等值连接的结果为多表的交集部分<br>②n表连接，至少需要n-1个连接条件<br>③多表的顺序没有要求<br>④一般需要为表起别名<br>⑤可以搭配前面介绍的所有子句使用，比如排序、分组、筛选</p>
<p>案例1：查询女神名和对应的男神名  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select name,boyname</span><br><span class="line">from boys,beauty</span><br><span class="line">where beauty.boyfriend_id &#x3D; boys.id;</span><br></pre></td></tr></table></figure>
<p><em>1、为表起别名</em><br><strong>注意：如果为表起了别名，则查询的字段就不能使用和原来的表名去限定</strong><br>案例2：查询员工名，工种号，工种名  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select last_name,e.job_id,job_title</span><br><span class="line">from employees as e, jobs as j</span><br><span class="line">where e.&#39;job_id&#39;&#x3D;j.&#39;job_id&#39;;</span><br></pre></td></tr></table></figure>
<p><em>2、可以加筛选</em><br>案例：查询有奖金的员工名、部门名  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select last_name,department_name,commission_pct</span><br><span class="line">from employees e, department d</span><br><span class="line">where e.&#39;department_id&#39;&#x3D;d.&#39;department_id&#39;</span><br><span class="line">and e.&#39;commission_pct&#39; is not null;</span><br></pre></td></tr></table></figure>
<p><em>3、实现三表连接</em><br>案例：查询员工名、部门名和所在的城市  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select last_name,department_name,city</span><br><span class="line">from employees e,departments d, location l</span><br><span class="line">where e.&#39;department_id&#39;&#x3D;d.&#39;department_id&#39;</span><br><span class="line">and d.&#39;location_id&#39;&#x3D;l.&#39;location_id&#39;</span><br></pre></td></tr></table></figure>
<p><strong>非等值连接</strong><br>案例1 ：查询员工的工资和工资级别  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select salary,grade_level</span><br><span class="line">from employees e, job_grades g</span><br><span class="line">where salary between g.lowest_sal and g.highest_sal;</span><br></pre></td></tr></table></figure>
<p><strong>自连接</strong><br>案例：查询员工名和上级的名称  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select e.employee_id,e.last_name,m.employee_id,m.last_name</span><br><span class="line">from employees e,employees m</span><br><span class="line">where e.manage_id &#x3D; m.employee_id;</span><br></pre></td></tr></table></figure>
<p><strong>199标准</strong><br>语法：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">from 表1 别名 </span><br><span class="line">【连接类型】join 表2 别名</span><br><span class="line">on 连接条件</span><br><span class="line">【where 筛选条件】</span><br><span class="line">【group by]</span><br><span class="line">【having】</span><br><span class="line">【order by】</span><br></pre></td></tr></table></figure>
<p>分类：</p>
<ul>
<li>内连接（√）：inner</li>
<li>外连接<ul>
<li>左外（√）：left 【outer】</li>
<li>右外（√）：right【outer】</li>
<li>全外：full【outer】</li>
</ul>
</li>
<li>交叉连接：cross  </li>
</ul>
<p><strong>等值连接</strong><br>特点  </p>
<ul>
<li>添加排序、分组、筛选</li>
<li>inner可以省略</li>
<li>筛选条件放在where后面，连接条件放在on后面，增强可读</li>
<li>inner join和sq192等值连接效果一样，都是查询多表的交集 </li>
</ul>
<p>案例1： 查询员工名、部门名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select last_name,department_name</span><br><span class="line">from employees e</span><br><span class="line">inner join departments d</span><br><span class="line">on e.department_id &#x3D; d.department_id;</span><br></pre></td></tr></table></figure>
<p>案例2：查询员工名、部门名、工种名，并按部门名降序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select last_name,department_name,job_title</span><br><span class="line">from employees e</span><br><span class="line">inner join departments d on e.department_id&#x3D;d.department_id</span><br><span class="line">inner join jobs j on e.job_id&#x3D;j.job_id</span><br><span class="line">order by department_name DESC;</span><br></pre></td></tr></table></figure>
<p><strong>非等值连接</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select salary,grade_level</span><br><span class="line">from employees e</span><br><span class="line">join job_grages g</span><br><span class="line">on e.salary between g.lowest_sal and g.highest_sal</span><br></pre></td></tr></table></figure>
<p><strong>自连接</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select e.last_name,m.last_name</span><br><span class="line">from employees e </span><br><span class="line">join employees m</span><br><span class="line">on e.manage_id &#x3D; m.employee_id</span><br></pre></td></tr></table></figure>
<p><strong>外连接</strong><br>应用场景：用于查询一个表中有，另一个表没有的记录<br>特点：</p>
<ul>
<li>外连接的查询结果为主表中的所有记录 <ul>
<li>如果从表中有和它匹配的，则显示匹配的值</li>
<li>如果从表中没有和它匹配的，则显示null</li>
<li>外连接查询结果=内连接结果+主表中有而从表中没有的记录</li>
</ul>
</li>
<li>左外连接，left join左边的是主表  </li>
<li>右外连接，right join右边的是主表</li>
<li>左外和右外交换两个表的顺序，可以实现相同的效果  </li>
<li>全外连接=内连接+表1中有但表2没有+表2中有但表1没有  </li>
</ul>
<p>案例：查询男朋友不在男神表的女神名  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select * from beauty;</span><br><span class="line">select * from boys;</span><br><span class="line">select b.name,bo.*</span><br><span class="line">from beauty b</span><br><span class="line">left outer join boy bo</span><br><span class="line">on b.boyfriend_id &#x3D; bo.id</span><br><span class="line">where bo.id is null</span><br><span class="line">;</span><br></pre></td></tr></table></figure>
<p><strong>交叉连接</strong>(笛卡尔乘积)  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select b.*,bo.*</span><br><span class="line">from beauty b</span><br><span class="line">cross join boys bo;</span><br></pre></td></tr></table></figure>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>含义：出现在其他语句中的select语句，称为子查询或内查询<br>外部的查询语句，称为主查询或外查询<br>分类：</p>
<ul>
<li>按子查询出现的位置：<ul>
<li>select后面：仅仅支持标量子查询</li>
<li>from 后面：支持表子查询</li>
<li>where或having后面：（❤）<ul>
<li>标量子查询（√）</li>
<li>列子查询（√）</li>
<li>行子查询</li>
</ul>
</li>
<li>exists 后面（相关子查询）：支持表子查询</li>
</ul>
</li>
<li>按结果集的行列数不同：<ul>
<li>标量子查询（结果集只有一行一列）</li>
<li>列子查询（结果集一列多行）</li>
<li>行子查询（一行多列）</li>
<li>表子查询（多行多列）</li>
</ul>
</li>
</ul>
<p>特点：</p>
<ul>
<li>子查询放在小括号内</li>
<li>子查询一般放在条件的右侧</li>
<li>标量子查询，一般搭配着单行操作符使用 &gt; &lt; &gt; &gt;= &lt;= &lt;&gt;</li>
<li>列子查询，一般搭配着多行操作符使用</li>
<li>子查询的执行优先于主查询，主查询的条件用到了子查询的结果  </li>
</ul>
<h4 id="标量子查询"><a href="#标量子查询" class="headerlink" title="标量子查询"></a>标量子查询</h4><p>案例1：谁的工资比Abel高？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from employees</span><br><span class="line">where salary&gt;(</span><br><span class="line">    select salary</span><br><span class="line">    from employees</span><br><span class="line">    where last_name &#x3D; &#39;Abel&#39;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><em>非法使用标量子查询</em>：<br>子查询结果不是一行一列  </p>
<h4 id="列子查询"><a href="#列子查询" class="headerlink" title="列子查询"></a>列子查询</h4><ul>
<li>返回多行</li>
<li>多行比较操作符  <ul>
<li>IN/NOT IN 等于列表中的任意一个</li>
<li>ANY/SOME 和子查询返回的某一个值比较</li>
<li>ALL 和子查询返回的所有值比较  </li>
</ul>
</li>
</ul>
<p>案例1：返回location_id是1400或1700的部门中的所有员工姓名  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select last_name</span><br><span class="line">from employees</span><br><span class="line">where department_id in(</span><br><span class="line">    select distinct department_id</span><br><span class="line">    from departments</span><br><span class="line">    where location_id in(1400,1700)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="行子查询"><a href="#行子查询" class="headerlink" title="行子查询"></a>行子查询</h4><p>案例2：查询员工编号最小并且工资最高的员工信息<br>普通写:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from employees</span><br><span class="line">where employee_id&#x3D;(</span><br><span class="line">    select MIN(employee_id)</span><br><span class="line">    from employees</span><br><span class="line">)and salary&#x3D;(</span><br><span class="line">    select MAX(salary)</span><br><span class="line">    from employees</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>行子查询写法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select *</span><br><span class="line">from employees</span><br><span class="line">where (employee_id,salary)&#x3D;(</span><br><span class="line">    select MIN(employee_id),MAX(salary)</span><br><span class="line">    from employees</span><br><span class="line">);</span><br><span class="line">&#96;&#96;&#96; </span><br><span class="line">#### select 后面</span><br><span class="line">- 仅支持标量子查询  </span><br><span class="line"></span><br><span class="line">案例：查询每个部门的员工个数</span><br></pre></td></tr></table></figure>
<p>select d.<em>,(<br>    select count(</em>)<br>    from employees e<br>    where e.department_id = d.department_id<br>) 个数<br>from departments d;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">案例：查询员工号&#x3D;102的部门名</span><br></pre></td></tr></table></figure>
<p>select(<br>    select department_name<br>    from departments d<br>    inner join employees e<br>    on d.department_id=e.department_id<br>    where e.employee_id=102<br>) 部门名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#### from 后面  </span><br><span class="line">- 将子查询结果充当一张表，要求必须起别名  </span><br><span class="line"></span><br><span class="line">案例：查询每个部门的平均工资的工资等级</span><br></pre></td></tr></table></figure>
<p>select avg_dep.*,g.grade_level<br>from (<br>    select AVG(salary) ag,department_id<br>    from employees<br>    group by department_id<br>)avg_dep<br>inner join job_grades g<br>on avg_dep.ag between lowest_sal and highest_sal;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#### exists 后面（相关子查询）  </span><br><span class="line">语法：exists(完整的查询语句)</span><br><span class="line">结果：1或0  </span><br><span class="line">案例1：查询有员工的部门名</span><br></pre></td></tr></table></figure>
<p>select department_name<br>from departments d<br>where exists(<br>    select *<br>    from employees e<br>    where d.department_id = e.department_id<br>);<br>```</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-【MySQL】02" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2020/06/25/%E3%80%90MySQL%E3%80%9102/" class="article-date">
      <time datetime="2020-06-25T09:01:26.589Z" itemprop="datePublished">2020-06-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2020/06/25/%E3%80%90MySQL%E3%80%9102/">【MySQL】02</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h3><p>语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select 查询列表</span><br><span class="line">from 表</span><br><span class="line">[where 筛选条件]</span><br><span class="line">order by 排序列表 [asc|desc]</span><br></pre></td></tr></table></figure>
<p><strong>特点</strong></p>
<ul>
<li>asc 升序 desc 降序 如果不写，默认升序</li>
<li>order by 子句中支持单个字段、多个字段、表达式、函数、别名</li>
<li>order by 一般放在查询语句的最后面，limit子句除外</li>
</ul>
<p>案例1：查询员工信息，要求工资从高到低排序<br><code>select * from employees order by salary desc;</code><br>从低到高<br><code>select * from employees order by salary asc;</code></p>
<p>案例2：查询部门编号&gt;=90的员工信息，按入职时间的先后进行排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">    *</span><br><span class="line">from </span><br><span class="line">    employees</span><br><span class="line">where</span><br><span class="line">    department_id &gt;&#x3D; 90</span><br><span class="line">order by</span><br><span class="line">    hiredate asc</span><br></pre></td></tr></table></figure>
<p>案例3：按年薪的高低显示员工的信息和年薪【按表达式排序】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *,salary*12*(1+IFNULL(commission_pct,0)) 年薪</span><br><span class="line">from employees</span><br><span class="line">order by salary*12(1+IFNULL(commission_pct,0)) DESC;</span><br></pre></td></tr></table></figure>
<p>案例4：按年薪的高低显示员工的信息和年薪【别名】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select *,salary*12*(1+IFNULL(commission_pct,0)) 年薪</span><br><span class="line">from employees</span><br><span class="line">order by 年薪 DESC;</span><br></pre></td></tr></table></figure>
<p>案例5：按姓名的长度显示员工的姓名和工资【按函数排序】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select LENGTH(last_name) 字节长度,last_name,salary</span><br><span class="line">from employees</span><br><span class="line">order by length(last_name) DESC;</span><br></pre></td></tr></table></figure>
<p>案例6：查询员工信息，要求先按工资排序，再按员工编号排序【按多个字段排序】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">selet *</span><br><span class="line">from employees</span><br><span class="line">order by salary ASC,employee_id DESC;</span><br></pre></td></tr></table></figure>

<h2 id="常见函数"><a href="#常见函数" class="headerlink" title="常见函数"></a>常见函数</h2><h3 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h3><p>调用：<br><strong>select 函数名（实参列表） 【from 表】</strong><br>分类：</p>
<ul>
<li>单行函数 如 concat、length、ifnull等</li>
<li>分组函数 功能：做统计使用，又称统计函数、聚合函数、组函数  <h4 id="字符函数"><a href="#字符函数" class="headerlink" title="字符函数"></a>字符函数</h4></li>
<li>length 获取参数值的字节个数<br><code>select length(&#39;john&#39;)</code><br><code>select length(&#39;张三丰hahaha&#39;)</code><br>一个中文字符占三个字节 UTF8</li>
<li>concat 拼接字符串<br><code>select concat(last_name,&#39;_&#39;,first_name) from employees</code></li>
<li>upper、lower 变大小写<br><code>select upper(&#39;john&#39;);</code></li>
<li>substr、substring  </li>
</ul>
<p><strong>注意：索引从1开始</strong><br><code>select substr(&#39;李莫愁爱上&#39;,4) out_put;</code><br><strong>截取从指定索引处指定字符长度的字符</strong><br><code>select substr(&#39;李莫愁爱上&#39;,1,3) out_put;</code></p>
<p>案例：姓名中首字符大写，其他字符小写然后用_拼接，显示出来  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">    concat(upper(substr(last_name,1,1)),&#39;_&#39;,lower(substr(last_name,2))) out_put</span><br><span class="line">from </span><br><span class="line">    employees;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>instr<br>返回子串第一次出现的索引，如果找不到返回0<br><code>select instr(&#39;杨不悔爱上了殷六侠&#39;,&#39;殷六侠&#39;) as out_put;</code></p>
</li>
<li><p>trim<br>去掉前后字符<br><code>select length(trim(&#39;    张翠山    &#39;)) as out_put;</code><br><code>select trim(&#39;a&#39; from &#39;aaa张aaa翠山aaa&#39;) as out_put;</code></p>
</li>
<li><p>lpad<br>用指定的字符实现左填充指定长度，其中长度为总长度<br><code>select LPAD(&#39;殷素素&#39;,10,&#39;*&#39;) as out_put;</code></p>
</li>
<li><p>rpad<br>用指定的字符实现右填充指定长度，其中长度为总长度<br><code>select LPAD(&#39;殷素素&#39;,12,&#39;ab&#39;) as out_put;</code></p>
</li>
<li><p>replace 替换<br><code>select replace(&#39;张无忌爱上了周芷若&#39;,&#39;周芷若&#39;,&#39;赵敏&#39;) as out_put;</code></p>
</li>
</ul>
<h4 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h4><ul>
<li>round 四舍五入<br><code>select round(-1.55);# 先去符号再取值</code><br><code>select round(1.567,2); # 取小数点后两位</code>  </li>
<li>ceil 向上取整，返回&gt;=该参数的最小整数  </li>
<li>floor 向下取值，返回&lt;=该参数的最大整数  </li>
<li>truncate 截断<br><code>select truncate(1.699,1);</code> #取小数点后一位  </li>
<li>mod 取余  </li>
</ul>
<p><strong>注意：mod(a,b):  a-a/b*b</strong><br><code>-select MOD(10,-3);</code> #被除数为正，结果为正<br><code>-select 10%3</code></p>
<h4 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h4><ul>
<li>now 返回当前系统日期+时间<br><code>select now();</code>  </li>
<li>curdate 返回当前系统日期，不包含时间<br><code>select curdate();</code>  </li>
<li>curtime 返回当前时间，不包含日期<br><code>select curtime();</code>  </li>
<li>可以获取指定的部分，年、月、日、小时、分钟、秒<br><code>select year(now()) 年;</code><br><code>select year(hiredate) 年 from employees;</code></li>
<li>str_to_data 将字符串通过指定的格式转换为日期<br><code>select str_to_data(&#39;1992-3-2&#39;,&#39;%Y-%c-%d&#39;) as out_put;</code><br><img src="catch1.png" alt="字符含义"></li>
<li>date_format 将日期转换为字符<br><code>select data_format(now(),&#39;%y年%m月%d日&#39;) as out_put;</code>  <h4 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h4><code>select version();</code><br><code>select database();</code><h4 id="流程控制函数"><a href="#流程控制函数" class="headerlink" title="流程控制函数"></a>流程控制函数</h4></li>
<li>if 函数<br><code>select if(10&gt;5,&#39;大&#39;,&#39;小&#39;)</code><br><code>select last_name,commission_pct,IF(commission_pct IS NULL,&#39;没奖金，呵呵&#39;,&#39;有奖金，嘻嘻&#39;) 备注</code>  </li>
<li>case 函数  </li>
</ul>
<p><strong>使用1： switch case 的效果</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">switch(变量或表达式)&#123;</span><br><span class="line">    case 常量1: 语句1; break;</span><br><span class="line">    ...</span><br><span class="line">    default:语句n; break;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mysql中  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">case 要判断的字段或表达式  </span><br><span class="line">when 常量1 then 要显示的值1或语句1  </span><br><span class="line">when 常量2 then 要显示的值2或语句2  </span><br><span class="line">...  </span><br><span class="line">else 要显示的值n或语句n</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>案例1 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select salary 原始工资, deparment_id,</span><br><span class="line">case deparment_id </span><br><span class="line">when 30 then salary*1.1  </span><br><span class="line">when 40 then salary*1.2</span><br><span class="line">when 50 then salary*1.3  </span><br><span class="line">else salary</span><br><span class="line">end as 新工资</span><br><span class="line">from employees;</span><br></pre></td></tr></table></figure>
<p><strong>使用2：类似于多重if</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">case </span><br><span class="line">when 条件1 then 要显示的值1或语句1  </span><br><span class="line">when 条件2 then 要显示的值2或语句2  </span><br><span class="line">...  </span><br><span class="line">else 要显示的值n或语句n</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h3 id="分组函数"><a href="#分组函数" class="headerlink" title="分组函数"></a>分组函数</h3><p>用作统计使用，又称为聚合函数或统计函数或组函数<br>分类：<br>sum 求和 、avg 平均值、 max 最大值、 min 最小值、 count 计算个数  </p>
<ul>
<li>简单使用<br><code>select sum(salary) from employees;</code></li>
<li>参数支持哪些类型  </li>
</ul>
<p><strong>特点</strong>   </p>
<ol>
<li>sum、avg只用于处理数值型  </li>
<li>min max count 可以处理任何类型  </li>
<li>以上分组函数都忽略NULL值</li>
<li>和distinct搭配 (去重)<br><code>select count(distinct salary),count(salary) from employees;</code>  </li>
<li>count函数的详细介绍<br><code>select count(*) from employees;</code> #统计行数<br><code>select count(1) from employees;</code> #也是统计函数<br>#相当于加了1列1，统计了一下1的个数<br>效率：<br>MYISAM存储引擎下，count(<em>)效率高<br>INNODB存储引擎下，count(</em>)和count(1)差不多，比count(“”)加字符效率高  </li>
<li>和分组函数一同查询的字段要求是group by后的字段<br>案例： 查询员工表中最大入职时间和最小入职时间的相差天数<br><code>select datediff(now(),&#39;1995-1-1&#39;);</code><br><code>select datediff(max(hiredate),min(hiredate)) difference
from employees;</code></li>
</ol>
<h3 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h3><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select 分组函数，列（要求出现在group by的后面）</span><br><span class="line">from 表</span><br><span class="line">【where 筛选条件】</span><br><span class="line">group by 分组的列表</span><br><span class="line">【order by 子句】</span><br></pre></td></tr></table></figure>
<p>注意：查询列表必须特殊，要求是分组函数和group by后出现的字段<br>特点：1、分组查询中的筛选条件分为两类<br>| - | 数据源 | 位置 | 关键字|<br>| :—–| :—-: | :—-: |:—-: |<br>| 分组前筛选 | 原始表 | group by子句的前面 |where |<br>| 分组后筛选 | 分组后的结果集 | group by子句的后面 |having |<br><strong>①分组函数做条件肯定放在having子句中</strong><br><strong>②能用分组前筛选的，优先考虑使用分组前筛选</strong><br>2、group by子句支持单个字段、多个字段分组，表达式或函数（用得较少）<br>3、也可以添加排序（放在最后）<br>案例1：查询每个工种的最高工资  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select max(salary),job_id</span><br><span class="line">from employees</span><br><span class="line">group by job_id;</span><br></pre></td></tr></table></figure>
<p>添加分组后的筛选<br>案例2：<br>① 查询每个部门的员工个数  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select count(*),department_id</span><br><span class="line">from employees</span><br><span class="line">group by department_id;</span><br></pre></td></tr></table></figure>
<p>② 根据①的结果进行筛选，查询哪个部门的员工个数&gt;2  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select count(*),department_id</span><br><span class="line">from employees</span><br><span class="line">group by department_id</span><br><span class="line">having count(*)&gt;2;</span><br></pre></td></tr></table></figure>
<ul>
<li>按表达式分组<br>案例：按员工姓名的长度分组，查询每一组的员工个数，筛选员工个数&gt;5的有哪些<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select count(*),length(last_name) len_name</span><br><span class="line">from employees</span><br><span class="line">group by length(last_name)</span><br><span class="line">having count(*)&gt;5;</span><br></pre></td></tr></table></figure></li>
<li>按多个字段分组<br>案例：查询每个部门每个工种的员工的平均工资  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select AVG(salary),department_id,job_id</span><br><span class="line">from employees</span><br><span class="line">group by job_id,department_id;</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-【MySQL】01" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2020/06/25/%E3%80%90MySQL%E3%80%9101/" class="article-date">
      <time datetime="2020-06-25T09:01:26.585Z" itemprop="datePublished">2020-06-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2020/06/25/%E3%80%90MySQL%E3%80%9101/">【MySQL】01</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="数据库的介绍"><a href="#数据库的介绍" class="headerlink" title="数据库的介绍"></a>数据库的介绍</h3><p>保存数据的容器：</p>
<ul>
<li>数组 内存</li>
<li>集合 内存</li>
<li>文件 不太适合查询  <h4 id="DB（database）：存储数据的仓库"><a href="#DB（database）：存储数据的仓库" class="headerlink" title="DB（database）：存储数据的仓库"></a>DB（database）：存储数据的仓库</h4><h4 id="DBMS（Database-Management-System-："><a href="#DBMS（Database-Management-System-：" class="headerlink" title="DBMS（Database Management System) ："></a>DBMS（Database Management System) ：</h4></li>
<li>数据库管理系统  </li>
<li>常见的数据库管理系统：MySQL、Oracle、DB2、sqlserver<h4 id="SQL-Structure-Query-Language"><a href="#SQL-Structure-Query-Language" class="headerlink" title="SQL(Structure Query Language):"></a>SQL(Structure Query Language):</h4></li>
<li>结构化查询语言</li>
<li>专门与DBMS通信的语言<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4></li>
<li>数据-&gt;表-&gt;库</li>
<li>库里可以有多个表，每个表都有一个名字，表名具有唯一性</li>
<li>表：特性，这些特性定义了数据在表中如何存储</li>
<li>表由列组成 列：字段</li>
<li>表按行存储</li>
</ul>
<h3 id="MySQL的常见命令"><a href="#MySQL的常见命令" class="headerlink" title="MySQL的常见命令"></a>MySQL的常见命令</h3><ul>
<li>查看当前所有的数据库:<br><code>show databases;</code></li>
<li>打开指定的库:<br><code>use 库名;</code></li>
<li>查看当前库的所有表:<br><code>show tables;</code></li>
<li>查看其他库的所有表:<br><code>show tables from 库名;</code></li>
<li>创建表:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">    列名 列类型,</span><br><span class="line">    列名 列类型,</span><br><span class="line">    ....</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li>查看表结构:<br><code>desc 表名;</code></li>
<li>查看服务器的版本:<br>方式一：登录到mysql服务端<br><code>select version();</code><br>方式二：没有登录到mysql服务端<br><code>mysql --version或mysql --V</code></li>
</ul>
<h3 id="MySQL的语法规范"><a href="#MySQL的语法规范" class="headerlink" title="MySQL的语法规范"></a>MySQL的语法规范</h3><ul>
<li>不区分大小写，但建议关键字大写，表名、列名小写</li>
<li>每条命令最好用分号结尾，也可以用\g</li>
<li>每条命令根据需要，可以进行缩进或换行</li>
<li>注释<br>  单行注释 ：#注释文章<br>  单行注释 ：- - 注释文字（有空格）<br>  多行注释 ：/* 注释文字 */</li>
</ul>
<h3 id="DQL语言（查询）"><a href="#DQL语言（查询）" class="headerlink" title="DQL语言（查询）"></a>DQL语言（查询）</h3><h4 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h4><p>语法：<br><code>select 查询列表 from 表名;</code></p>
<ul>
<li>可以查表中的字段、常量值、表达式、函数</li>
<li>查询的结果是一个虚拟的表格:  </li>
</ul>
<p>例如<br>查询表中的单个字段:<br><code>select last_name from employees;</code><br>查询表中的多个字段:<br><code>select last_name,salary,email from employees;</code><br>(用逗号隔开)<br>查询表中的所有字段:<br><code>select * from employees;</code><br>(顺序就不能更改了)<br><strong>着重号`name`可以用来区分是关键字还是字段</strong><br>查询常量值:<br><code>select 100;</code>  <code>select &#39;join&#39;;</code><br>(数据库中没有字符串概念)<br>查询表达式:<br><code>select 100*98;</code><br>查询函数:<br><code>select version();</code></p>
<ul>
<li>起别名(①便于理解②可以区分重名)  </li>
</ul>
<p><strong>方式一 使用as</strong><br><code>select 100*98 as 结果;</code><br><code>select last_name as 姓,first_name as 名 from employees;</code><br><strong>方式二 使用空格</strong><br><code>select last_name 姓 from employees;</code><br>如果别名里有空格，出现歧义，加双引号</p>
<ul>
<li>去重<br><code>select distinct department_id from employees;</code></li>
<li>+号的作用  </li>
</ul>
<p>+号：运算符 转换失败为0，有一方为Null, 结果为Null<br>连接的话 用CONCAT;<br><code>select CONCAT(last_name,first_name) as 姓名 from employees;</code></p>
<ul>
<li>如果拼接的时候 里面有Null 用函数判断  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">    IFNULL(commission_pct,0) as 奖金率</span><br><span class="line">    commission_pct</span><br><span class="line">from </span><br><span class="line">    employees;</span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line"></span><br><span class="line">#### 条件查询</span><br><span class="line">语法：</span><br><span class="line">&#96;select 查询列表 from 表名 where 筛选条件;&#96;  </span><br><span class="line">分类：</span><br><span class="line">- 按条件表达式筛选  条件运算符：&gt; &lt;&gt; &#x3D; !&#x3D; &lt;&gt; &gt;&#x3D; &lt;&#x3D;</span><br><span class="line">- 按逻辑表达式筛选 逻辑运算符：&amp;&amp; || ! and or not</span><br><span class="line">&amp;&amp;和and</span><br><span class="line">||或or</span><br><span class="line">!非not</span><br><span class="line">- 模糊查询 like, between and, in, is null|is not null  </span><br><span class="line"></span><br><span class="line">案例1：查询员工名中包含字符a的员工信息</span><br></pre></td></tr></table></figure>
select<br>  *<br>from<br>  employees<br>where<br>  last_name LIKE ‘%a%’;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">**LIKE**  </span><br><span class="line">- 一般和通配符搭配使用  </span><br><span class="line">通配符：  </span><br><span class="line">% 任意多个字符，包含0个字符  </span><br><span class="line">_ 任意单个字符</span><br><span class="line"></span><br><span class="line">案例2：查询员工中第三个字符为e, 第五个字符为a的员工名和工资</span><br></pre></td></tr></table></figure>
select<br>  *<br>from<br>  employees<br>where<br>  last_name LIKE ‘__e_a%’;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">案例3：查询员工名中第二个字符为_的员工名</span><br></pre></td></tr></table></figure>
select<br>  *<br>from<br>  employees<br>where<br>  last_name LIKE ‘<em>\</em>%’;<br>或者 last_name LIKE ‘<em>$</em>%’ escape ‘$’;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**between and**  </span><br><span class="line">- 提高语句的简洁度</span><br><span class="line">- 包含临界值</span><br><span class="line">- 两个临界值不能调换顺序</span><br><span class="line"></span><br><span class="line">案例：查询员工编号在100到120之间的员工信息</span><br></pre></td></tr></table></figure>
select<br>  *<br>from<br>  employees<br>where<br>  employee_id between 100 and 120;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">**in**  </span><br><span class="line">- in列表的值类型必须一致或兼容</span><br><span class="line">- 不支持like中的通配符</span><br><span class="line"></span><br><span class="line">案例：查询员工的工种编号是 IT_PROG、AD_VP、AD_PRES中的一个员工名和工种编号</span><br></pre></td></tr></table></figure>
select<br>  last_name,<br>  job_id<br>from<br>  employees<br>where<br>  job_id = ‘IT_PROT’ or job_id=’AD_VP’ or job_id=’AD_PRES’;<br>也可以<br>  job_id IN (‘IT_PROT’,’AD_VP’,’AD_PRES’);<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">**is null&#x2F;is not null**</span><br><span class="line">- &#x3D;或&lt;&gt;不能用于判断null值</span><br><span class="line">- is null 或 is not null 可以判断null值  </span><br><span class="line">案例：查询没有奖金的员工名和奖金率</span><br></pre></td></tr></table></figure>
select<br>  last_name,<br>  commission_pct<br>from<br>  employees<br>where<br>  commission_pct is NULL;<br>```</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2020 Amber Wang
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>